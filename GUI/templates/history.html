<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Shor Run History ‚Äî QuantumX</title>
<style>
    :root {
        --bg-main-dark: #020617;
        --bg-main-light: #e5e7eb;
        --card-dark: #020617;
        --card-light: #ffffff;
        --text-dark: #e5e7eb;
        --text-light: #020617;
        --muted-dark: #9ca3af;
        --muted-light: #4b5563;
    }
    body { margin: 0; font-family: 'Segoe UI', sans-serif; transition: background 0.3s ease, color 0.3s ease; }
    body.dark-mode { background: var(--bg-main-dark); color: var(--text-dark); }
    body.light-mode { background: var(--bg-main-light); color: var(--text-light); }
    nav { background: #020617; color: #e5e7eb; padding: 14px 30px; display: flex; justify-content: space-between; align-items: center; }
    body.light-mode nav { background: #111827; }
    nav h1 { margin: 0; font-size: 22px; display: flex; align-items: center; gap: 6px; }
    .nav-links { display: flex; gap: 18px; align-items: center; }
    .nav-link { color: #cbd5e1; text-decoration: none; font-size: 14px; }
    .nav-link:hover { color: #ffffff; }
    .theme-toggle { border: 1px solid #4b5563; background: transparent; color: #e5e7eb; border-radius: 999px; padding: 4px 10px; font-size: 12px; cursor: pointer; display: flex; align-items: center; gap: 4px; }
    .page { max-width: 1000px; margin: 26px auto 40px; padding: 0 18px; opacity: 0; transform: translateY(8px); animation: fadeInUp 0.4s ease forwards; }
    .header-row { display: flex; justify-content: space-between; align-items: center; margin-bottom: 12px; flex-wrap: wrap; gap: 10px; }
    .filter-input {
        padding: 6px 8px;
        border-radius: 6px;
        border: 1px solid #4b5563;
        min-width: 220px;
        background: #020617;
        color: #e5e7eb;
    }
    body.light-mode .filter-input {
        background: #ffffff;
        color: #020617;
        border-color: #9ca3af;
    }
    table {
        width: 100%;
        border-collapse: collapse;
        margin-top: 10px;
        background: #020617;
        border-radius: 12px;
        overflow: hidden;
    }
    body.light-mode table { background: #ffffff; }
    th, td {
        padding: 8px 10px;
        font-size: 13px;
        border-bottom: 1px solid #1f2937;
        text-align: left;
    }
    body.light-mode th, body.light-mode td {
        border-bottom-color: #e5e7eb;
    }
    th {
        background: #111827;
        font-weight: 600;
    }
    body.light-mode th {
        background: #e5e7eb;
    }
    tr:nth-child(even) {
        background: #030712;
    }
    body.light-mode tr:nth-child(even) {
        background: #f9fafb;
    }
    .pill {
        display: inline-block;
        padding: 3px 8px;
        border-radius: 999px;
        font-size: 11px;
        background: #0f172a;
        color: #e5e7eb;
    }
    body.light-mode .pill {
        background: #e5e7eb;
        color: #111827;
    }
    .error-msg {
        font-size: 14px;
        color: #f97316;
        margin-top: 10px;
    }
    @keyframes fadeInUp { from { opacity: 0; transform: translateY(12px); } to { opacity: 1; transform: translateY(0); } }
</style>
</head>
<body class="dark-mode">
<nav>
    <h1> Shor Run History</h1>
    <div class="nav-links">
        <a href="{{ url_for('home') }}" class="nav-link">Dashboard</a>
        <a href="{{ url_for('rsa_page') }}" class="nav-link">RSA</a>
        <a href="{{ url_for('classical_page') }}" class="nav-link">Classical Shor</a>
        <a href="{{ url_for('quantum_page') }}" class="nav-link">Quantum Shor</a>
        <a href="{{ url_for('history') }}" class="nav-link">History</a>
        <a href="{{ url_for('help_page') }}" class="nav-link">Help</a>
        <a href="{{ url_for('quantum_qa') }}" class="nav-link">Q&amp;A</a>
        <button class="theme-toggle" type="button" onclick="toggleTheme()">
            <span id="theme-icon">üåô</span>
            <span id="theme-label">Dark</span>
        </button>
    </div>
</nav>

<div class="page">
    <div class="header-row">
        <div>
            <strong>Parsed runs from <code>shor_database.txt</code></strong><br>
            {% if data %}
                <span class="pill">{{ data|length }} entries</span>
            {% endif %}
        </div>
        <input type="text" class="filter-input" id="filterBox"
               placeholder="Filter by N, p, q, a, r..." oninput="filterTable()">
    </div>

    {% if error %}
        <div class="error-msg">{{ error }}</div>
    {% elif not data %}
        <div class="error-msg">No parsed entries found.</div>
    {% else %}
        <table id="historyTable">
            <thead>
            <tr>
                <th>N</th>
                <th>p</th>
                <th>q</th>
                <th>a</th>
                <th>r (period)</th>
            </tr>
            </thead>
            <tbody>
            {% for row in data %}
                <tr>
                    <td>{{ row.N }}</td>
                    <td>{{ row.p }}</td>
                    <td>{{ row.q }}</td>
                    <td>{{ row.a }}</td>
                    <td>{{ row.r if row.r is not none else '-' }}</td>
                </tr>
            {% endfor %}
            </tbody>
        </table>
    {% endif %}
</div>

<script>
    function applyTheme(theme) {
        const body = document.body;
        const icon = document.getElementById('theme-icon');
        const label = document.getElementById('theme-label');
        if (theme === 'light') {
            body.classList.remove('dark-mode');
            body.classList.add('light-mode');
            icon.textContent = '‚òÄÔ∏è';
            label.textContent = 'Light';
        } else {
            body.classList.remove('light-mode');
            body.classList.add('dark-mode');
            icon.textContent = 'üåô';
            label.textContent = 'Dark';
        }
    }
    function toggleTheme() {
        const current = localStorage.getItem('theme') || 'dark';
        const next = current === 'dark' ? 'light' : 'dark';
        localStorage.setItem('theme', next);
        applyTheme(next);
    }
    (function initTheme() {
        const saved = localStorage.getItem('theme') || 'dark';
        applyTheme(saved);
    })();

    function filterTable() {
        const input = document.getElementById('filterBox');
        const filter = input.value.toLowerCase();
        const table = document.getElementById('historyTable');
        if (!table) return;

        const rows = table.getElementsByTagName('tr');
        for (let i = 1; i < rows.length; i++) {
            const tds = rows[i].getElementsByTagName('td');
            let match = false;
            for (let j = 0; j < tds.length; j++) {
                const txt = tds[j].textContent || tds[j].innerText;
                if (txt.toLowerCase().indexOf(filter) > -1) {
                    match = true;
                    break;
                }
            }
            rows[i].style.display = match ? '' : 'none';
        }
    }
</script>
</body>
</html>
